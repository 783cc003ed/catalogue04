# BumbleBee Zeros in on Meterpreter

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2022/11/14/bumblebee-zeros-in-on-meterpreter/

Краткое содержание: 

<blockquote>
In this intrusion from May 2022, the threat actors used BumbleBee as the initial access vector from a Contact Forms campaign.   ...   <br>Then, the threat actors executed reg.exe to save a copy of the SAM, Security, and Software registry hives on the beachhead host.   ...   <br>Lateral movement was then performed over SMB, to transfer a Cobalt Strike Beacon DLL’s to other workstation’s C$\\ProgramData\.   ...   <br>After successfully exploiting the Domain controller, the threat actors used Pass the Hash to begin working in the context of a user who was a member of the Domain Admins group.   ...   <br>A Cobalt Strike Beacon DLL was then written over SMB to another Domain Controller and executed via a service.   ...   <br>The intrusion in this case began with a link to a google domain, storage.googleapis.com.   ...   <br>We assess with medium-high confidence that the one observed in our intrusion was likely from a contact form campaign, as the initial access URL was spotted in the wild across various sites, impersonating various companies’ legal teams, trying to entice the user to download and review the malicious files.   ...   <br>Both Meterpreter and Cobalt Strike payloads were used during this intrusion.   ...   <br>On the domain controller, a 4742 event was generated showing the beachhead host changing the password on the domain controller, matching the timestamps to the network data.   ...   <br>The threat actor dropped the Sysinternals executable procdump64.exe, which they then used to dump the lsass process.   ...   <br>Using the Cobalt Strike beacon, injected in a svchost.exe process, the threat actors dumped SAM, SECURITY, and SYSTEM hives using the native reg.exe utility.   ...   <br>The Discovery phase was carried out in this case using both native Windows tools, and external tools such as AdFind and PowerSploit.   ...   <br>After dumping the lsass.exe process on the beachhead machine, the threat actors then launched af.exe (AdFind) to find all user objects and computers in the domain.   ...   <br>Execution of the command was visible in the PowerShell 4103 and 4104 logs.   ...   
</blockquote>

Тэги: 


Дата публикования: 
2022-11-14T01:48:26+00:00

---

# Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/

Краткое содержание: 

<blockquote>
Remote access tools were used for command and control, such as Tactical RMM and Anydesk.   ...   <br>Windows net commands were run, targeting domain groups and computers, nltest was executed again, and they also used tasklist and ping to investigate a remote host.   ...   <br>They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.   ...   <br>Once on this new host the threat actors proceeded to run the net commands to review the Domain Administrators group again.   ...   <br>Again, some net command discovery was run for domain admins and domain controller servers.   ...   <br>The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers in the environment using Cobalt Strike beacon DLL’s.   ...   <br>On one of the other targeted servers, the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.   ...   <br>From this server, the threat actors were observed using Rclone to exfiltrate data from a file share server in the environment.   ...   <br>On the eighth day of the intrusion the threat actor accessed the environment using Tactical RMM to deploy Anydesk on the compromised host.   ...   <br>Finally, locker.dll and a batch file 1.bat were dropped on the host and the batch file was executed beginning the Quantum rasomware deployment to all hosts over SMB.   ...   <br>Both of the Cobalt Strike servers in this case were on our Threat Feed (days to months) in advance of this intrusion.   ...   <br>Once the PowerShell script from the LNK file executed successfully, Emotet began execution.   ...   <br>This was then executed by the threat actors and resulted in the installation of the main RMM agent.   ...   <br>On the final day of the intrusion, the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.   ...   <br>The threat actor was observed process injecting into legitimate process and using them to execute their own tasks on the system, this can be seen from Winlogon connecting to a domain associated with a Cobalt Strike server and removing files from the system.   ...   <br>Injected Process Name	Injection Payload C:\Windows\system32\winlogon.exe	Cobalt Strike C:\Windows\System32\RuntimeBroker.exe	Cobalt Strike C:\Windows\System32\svchost.exe	Cobalt Strike C:\Windows\System32\taskhostw.exe	Cobalt Strike C:\Windows\system32\dllhost.exe	Cobalt Strike PowerTool   ...   <br>PowerTool was observed, dropped and executed on the server used to deploy the ransomware payload.   ...   <br>Process access to LSASS was observed, likely to dump credentials from a process that was injected with Cobalt Strike.   ...   <br>In addition to the Invoke-ShareFinder command, other functions that were used by the script were also observed.   ...   <br>On the final day, prior to ransom deployment, the threat actor also dropped netscan.exe on the server, and executed it from the Tactical RMM meshagent.exe session.   ...   <br>The threat actor was observed creating remote services in order to execute beacon DLL files transferred via SMB as SYSTEM on remote hosts.   ...   <br>hxxps://descontador[.]com[.   ...   <br>]com) 139.60.161.167 (survefuz[.   ...   <br>The threat actor dropped a Tactical RMM Agent on one of the servers as an alternative command and control avenue to access the network.   ...   <br>This command reveals the floppasoftware.com domain used by the threat actor for the remote management of Tactical RMM Agent.   ...   <br>A domain registered to be used with Tactical RMM Agent will have both an api and mesh subdomain, in this case api.floppasoftware[.   ...   <br>Tactical RMM Agent was installed by the threat actor on a server to ensure remote access (17jun.exe).   ...   
</blockquote>

Тэги: 


Дата публикования: 
2022-11-28T01:13:34+00:00

---

