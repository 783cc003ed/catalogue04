# IcedID Macro Ends in Nokoyawa Ransomware

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/

Краткое содержание: 

<blockquote>
After reaching out to the initial command and control server, automated discovery ran from the IcedID process around two minutes after execution.   ...   <br>At this time, the malware also established persistence on the beachhead host using a scheduled task.   ...   <br>Following this activity, the threat actors conducted further reconnaissance, and then moved laterally to a Domain Controller through the execution of a Cobalt Strike payload via WMI.   ...   <br>On the fourth day, the threat actors returned briefly to execute a few commands on the Domain Controller related to the enumeration of domain computers and high privilege user account groups.   ...   <br>Early on the sixth day, the threat actors became active again launching the Edge browser on the beachhead host and appeared to download a file from dropmefiles[.]com.   ...   <br>Then, from the beachhead host, a new process was spawned from the IcedID malware; and from this shell, the threat actors began enumerating Active Directory using adget and AdFind.   ...   <br>After the intrusion, contact was made with the threat actors using their support site and the price of the ransom was quoted around $200,000 USD in Bitcoin.   ...   <br>In this case, the payload was written to the path retrieved from Application.DefaultFilePath, which is the default path used by Excel when it opens files.   ...   <br>Calc.exe (renamed rundll32.exe) is used to invoke the IcedID payload.   ...   <br>The threat actors were observed making use of an VNC module that was spawned by IcedID to spawn the Microsoft Edge browser:   ...   <br>The threat actors used Cobalt Strike beacons throughout the intrusion.   ...   <br>After initial Base64 decoding, we found the payload used the default Cobalt Strike XOR value of 35 which allows for the next step of decoding the payload.   ...   <br>After using PowerShell beacons during the first day on the beachhead host and a Domain Controller, the threat actors moved to using DLL files exclusively for the remainder of Cobalt Strike beacons deployed during the intrusion.   ...   <br>On the second day of the intrusion, after moving laterally to a Domain Controller, LSASS was accessed from a Cobalt Strike process.   ...   <br>The default chcp value is determined by the Windows locale.   ...   <br>Following the initial discovery commands mentioned above on day one, the threat actor scanned the network for port 1433, the default port used by Microsoft SQL server.   ...   <br>Threat Actors ran the following command to download and execute an in memory PowerShell payload on a domain controller:   ...   <br>The threat actors used PSExec to move laterally to servers during the ransom execution, the -r flag was used to rename the binary created on the remote server to mstdc.exe.   ...   <br>Threat actors also used RDP during this intrusion.   ...   <br>7.exe a -mx3 ad.7z ad_*   ...   <br>After initial connections, IcedID command and control traffic moved to the following servers.   ...   <br>Connections to one of the IcedID servers was observed in memory dumps from the beachhead host.   ...   <br>]119 observed from the renamed rundll32.exe that loaded the IcedID DLL during maldoc execution at the beginning of this case.   ...   <br>During the intrusion we also observed connections to a BackConnect VNC IP address.   ...   <br>]com on port 8081.   ...   <br>Later on day six, the threat actors added a new Cobalt Strike server to the intrusion, 5.8.18.242 on port 443 (see below for visualizing this activity).   ...   <br>]com	23.29.115.152	757	a0e9f5d64349fb13191bc781f81f42e1	f176ba63b4d68e576b5ba345bec2c7b7 aicsoftware[.   ...   <br>The threat actors opened the document from the IP:   ...   <br>AdFind Discovery id: 50046619-1037-49d7-91aa-54fc92923604   ...   <br>Unsecured Credentials: Credentials In Files - T1552.001 User Execution: Malicious File - T1204.002 Remote Services: Windows Remote Management - T1021.006 Exfiltration Over C2 Channel - T1041 Archive Collected Data: Archive via Utility - T1560.001 Ingress Tool Transfer - T1105 Web Service - T1102 OS Credential Dumping: LSASS Memory - T1003.001 Remote Access Software - T1219 AdFind - S0552 IcedID - S0483 ipconfig - S0100 net - S0039 nltest - S0359 ping - S0097 systeminfo - S0096 cmd - S0106 Cobalt Strike - S0154 PsExec - S0029   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-05-22T01:04:22+00:00

---

