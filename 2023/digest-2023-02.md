# Collect, Exfiltrate, Sleep, Repeat

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/

Краткое содержание: 

<blockquote>
In this intrusion from August 2022, we observed a compromise that was initiated with a Word document containing a malicious VBA macro, which established persistence and communication to a command and control server (C2).   ...   <br>As described in AutoHotkey documentation, the AHK script can be executed in a number of ways.   ...   <br>As observed in this intrusion, the adversary executed the AHK keylogger script by calling a renamed version of AutoHotkey.exe (module.exe) and passing the script’s filename (module.ahk) as a command-line parameter.   ...   <br>The threat actors began executing basic discovery commands, all of which were executed via PowerShell cmdlets or built-in Windows utilities like whoami, net, time, tzutil and tracert; one exception to this was when the threat actors extracted a specific function from the PowerSploit framework, Convert-LDAPProperty, to enumerate domain accounts in the environment.   ...   <br>A scheduled task was then created to assist in execution of the keylogger.   ...   <br>One interesting fact about this case is that the initial implant was fully implemented using PowerShell, and no executables were dropped to the victim’s workstation for the implant.   ...   <br>The first scheduled task installed using the malicious VBA macro, executed a VBS script, which in turn executed a PowerShell script named Script.ps1.   ...   <br>Get the account information for logged-on user of a Windows machine   ...   <br>Invoke-WebRequest -UseBasicParsing -Uri http://ident.me | out-string Collection   ...   <br>Threat actors also dropped and executed a PowerShell script using their temp.ps1 C2 script:   ...   <br>The screenshots were taken upon the execution of this PowerShell script and then they were saved in the same directory as sc.png files.   ...   <br>This is one of the ways in which you can execute an AutoHotkey (AHK) script.   ...   <br>makecab "C:\Users\<REDACTED>\AppData\Local\Temp\logFileuyovaqv.bin" C:\Users\<REDACTED>\AppData\Local\Temp\logFileuyovaqv.cab Command and Control   ...   <br>Activity to the C2 is established via execution of the Script.ps1 and temp.ps1 files.   ...   <br>Communication between the victim and C2 is encrypted using AES-CBC with the following Key and IV:   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-02-06T01:26:23+00:00

---

