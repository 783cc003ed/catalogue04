# From Blackbox .NET Remoting to Unauthenticated Remote Code Execution

Авторы: 


Ссылка на контент: 
https://code-white.com/blog/2023-07-from-blackbox-dotnet-remoting-to-rce/

Краткое содержание: 

<blockquote>
This is a story on discovering an Unauthenticated Remote Code Execution in a CRM product by the vendor ACT!.   ...   <br>What made this story special for us was that we had to take a blackbox approach at the beginning and the system was not exploitable with standard .NET Remoting payloads due to several reasons we’ll explain in this blog post.   ...   <br>It all started with our custom asset discovery system discovering a potential .NET Remoting service on one of our client’s systems at their Internet perimeter.   ...   <br>Also "Server requires a secure connection for this client" could have been an indicator for some kind of authentication/authorization mechanism.   ...   <br>Let’s have a look at the server implementation in more detail.   ...   <br>The ProcessMessage method makes a case differentiation based on a client header Convert.ToInt32((string)requestHeaders["sc_TransactionType"]).   ...   <br>With that said, the communication protocol we try to reproduce goes like this (we skip the Uninitialized case):   ...   <br>We also had to add some boiler-plate code because we didn’t have all the necessary DLLs but only the one from the shady website (which we checked of course in advance for backdoors, malware etc.).   ...   <br>sc_TransactionType had to be incremented accordingly for the final payload (see the switch case mentioned above).   ...   <br>sc_SharedKey and sc_SharedIV for the symmetric encryption of our exploit payload.   ...   <br>For the encryption of the payload a bit more C# code was needed.   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-07-10T00:00:00

---

