# 2022 Year in Review

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2023/03/06/2022-year-in-review/

Краткое содержание: 

<blockquote>
As we move into the new year, it’s important to reflect on some of the key changes and developments we observed and reported on in 2022.   ...   <br>This report contains aggregate data from all of our public reporting for the year 2022.   ...   <br>The following summarizes the various initial access techniques observed in our cases:   ...   <br>The below graphic displays the tools/methods used by threat actors after getting initial access via the initial access malware listed above.   ...   <br>There are some very common tasks that threat actors have been observed using PowerShell for, however, in general, due to its versatility, PowerShell can be used to achieve many different tasks.   ...   <br>These services are created to be run once as SYSTEM, and execute the threat actors’ payload.   ...   <br>Emotet was seen copying a DLL into the user’s AppData folder and executing it with rundll32, while Ursnif used a Run Key to execute a PowerShell script via a LNK file.   ...   <br>IcedID, Qbot, and Gootloader have all been observed making use of Scheduled Tasks to execute their payloads after the main execution of the malware.   ...   <br>In 2022, we saw the rise of various Remote Access Software tools, such as AnyDesk and Atera.   ...   <br>Exploit Leads to Data Exfiltration report we saw the RCE for SupportCenter Plus:   ...   <br>After process injection, another notable category is the pair of techniques T1218.010 and T1218.011, the use of Rundll32 and Regsvr32 as some of the favored tools in use by threat actors to execute their payloads.   ...   <br>For example, we can see Regsvr32 being utilized both in execution of the IcedID malware and later on to execute the ransomware binary from Stolen Images Campaign Ends in Conti Ransomware.   ...   <br>Here’s a look at the most common techniques we saw in 2022:   ...   <br>While the LSASS process is always the target, threat actors use a variety of tools to get at the credentials within.   ...   <br>The use of a framework such as Cobalt Strike may be noticed inside the “Dead or Alive an Emotet story” report:   ...   <br>The information below will focus on some of the most notable tools and commands we observed from our intrusions this past year.   ...   <br>The data above shows the command and record count of various discovery commands used by threat actors in our reports from 2022.   ...   <br>Looking at the data we have collected for the past year, it is clear that the most commonly used commands are the ones that leverage Windows binaries to gather information about the host and network, such as IP addresses, active connections, and system-related information.   ...   <br>They use it to spread malware, get access to sensitive areas of the network, and to access private data, systems, and services.   ...   <br>Below are the most common lateral movement methods we observed in our intrusions last year.   ...   <br>More information about this technique can be found in our second report on Cobalt Strike, “Cobalt Strike, a Defender’s Guide – Part 2”.   ...   <br>We have seen a combination of ways malicious operators copy a tool over to the remote host and then use Cobalt Strike to run it.   ...   <br>We saw the threat actors create and run a beacon DLL on the target host.   ...   <br>The execution was via Cobalt Strike and was initiated by the beachhead host.   ...   <br>C:\Windows\System32\cmd.exe /c rundll32.exe C:\ProgramData\x86.dll, StartA This provided the threat actors with SYSTEM access that they could further leverage to access additional credentials or use the session as a backup in case they lost their primary access.   ...   <br>In some cases, operators leveraging access from certain malware families use the same methods to move laterally; one example of this is the post-exploitation activities following Bumblebee malware infections(1,2,3).   ...   <br>These operators apparently favored the remote creation and execution of the remote administration tool AnyDesk using SMB connections.   ...   <br>Although, in two reports last year we observed threat actors manually reviewing share data while still in the network, allowing a defender to see what data was accessed by the threat actors.   ...   <br>In this same case, we saw not just one, but multiple remote access tools with TacticalRMM/MeshCentral being used in tandem with Anydesk.   ...   <br>As seen in the Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware report, we can see how the threat actor used Rclone and MEGA:   ...   <br>Cobalt Strike was still utilized for command and control in 53% of all our reports through the year and was the only common Red Team tool utilized other than Meterpreter.   ...   <br>Rclone Execution via Command Line or PowerShell   ...   <br>Below are some of the most common JA3 hashes we observed this year.   ...   <br>An Emotet Story BumbleBee: Round Two Follina Exploit Leads to Domain Compromise BumbleBee Zeros in on Meterpreter Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware Share this: Twitter LinkedIn Reddit Facebook WhatsApp Related   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-03-06T02:37:40+00:00

---

# JMX Exploitation Revisited

Авторы: 


Ссылка на контент: 
https://code-white.com/blog/2023-03-jmx-exploitation-revisited/

Краткое содержание: 

<blockquote>
connection.invoke(objectName, "getOutputProperties", new Object[0], new String[0]);   ...   <br>connection.invoke(objectName, "newTransformer", new Object[0], new String[0]);   ...   <br>new String[] { Object.class.getName(), String.class.getName() }   ...   <br>While working on the implementation of some of the insights described here into beanshooter, Tobias pointed out that it is also possible to invoke static methods on arbitrary classes.   ...   <br>And my assumption was that for calling static methods, the object instance provided as first argument to Method.invoke(Object, Object...) must be null.   ...   <br>static ModelMBeanOperationInfo createModelMBeanOperationInfo(String declaringClass, String methodName, MBeanParameterInfo[] signature) {   ...   <br>So, for instance, for creating a ModelMBeanOperationInfo for System.setProperty(String, String), the following can be used:   ...   <br>new String[] { Object.class.getName(), String.class.getName() }   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-03-20T00:00:00

---

