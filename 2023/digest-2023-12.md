# Lets Open(Dir) Some Presents: An Analysis of a Persistent Actor’s Activity

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2023/12/18/lets-opendir-some-presents-an-analysis-of-a-persistent-actors-activity/

Краткое содержание: 

<blockquote>
By analyzing tools, logs and artifacts left open to the internet, we were able to profile the threat actor and their victims.   ...   <br>In this case, we have structured the report around the Diamond Model (Victim, Capability, Adversary, Infrastructure).   ...   <br>Government Defense Contractors Finance (Banking, Investing and Crypto) Critical Infrastructure Telecommunications Escort Services VPS Providers Security Companies Education Media and Political Groups   ...   <br>Below are some of the political groups and media organizations that were targeted by the threat actor:   ...   <br>From the bash history, we can see the threat actor using shodan to search for CVE-2022-42475:   ...   <br>The bash history file recorded the execution of these tools and the commands used:   ...   <br>In the Metasploit and Meterpreter history files we observed the following exploit modules used by the threat actor:   ...   <br>In this session, the threat actor gained nt authority\system access and was observed performing some initial system discovery, as well as using the type command to write out a certificate file matching the name of one of the targets.   ...   <br>A ‘honeypoc’ is a file released, which purports to be a proof-of-concept exploit for a highly sough after CVE when in reality it is a ruse that includes a canary token, which allows the authors to publish research on the use of publicly available exploits and persons who execute downloaded exploits without reading the source code.   ...   <br>From the Meterpreter history we observed the shell command used which will give the actor a standard shell on the target system.   ...   <br>They also used sc to create a service for a Sliver implant to gain persistence:   ...   <br>From the Metasploit history, we observed the threat actor using various Linux privilege escalation modules:   ...   <br>The threat actor used various techniques to access hashes and credentials of the target hosts.   ...   <br>The threat actor used the PowerView module Find-InterestingDomainShareFile to search for password files:   ...   <br>Other discovery commands that were used by the threat actor while using Sliver include the following:   ...   <br>The threat actor used the Meterpreter module portfwd to establish a reverse port forward with the C2 IP:   ...   <br>While we didn’t observe the use of this tool, it can be used to create a proxy between victim and threat actor.   ...   <br>Scanning IP Blocks - T1595.001 Vulnerability Scanning - T1595.002 Wordlist Scanning - T1595.003 Search Open Technical Databases - T1596 Exploit Public-Facing Application - T1190 Web Shell - T1505.003 Service Execution - T1569.002 Scheduled Task - T1053.005 Unix Shell Configuration Modification - T1546.004 Abuse Elevation Control Mechanism - T1548 Disable or Modify Tools - T1562.001 Security Account Manager - T1003.002   ...   <br>DCSync - T1003.006 Golden Ticket - T1558.001 Credentials in Files - T1081 Private Keys - T1552.004 Domain Account - T1087.002 Local Account - T1087.001 Group Policy Discovery - T1615 File and Directory Discovery - T1083 Local Groups - T1069.001 Domain Groups - T1069.002 System Network Configuration Discovery - T1016 System Information Discovery - T1082 System Owner/User Discovery - T1033 PowerShell - T1059.001 Protocol Tunneling - T1572 Web Protocols - T1071.001 Exfiltration Over C2 Channel - T1041 Resource Hijacking - T1496 Exploitation for Privilege Escalation - T1068 Multi-hop Proxy - T1090.003 Masquerading - T1036 Masquerade Task or Service - T1036.004 Windows Command Shell - T1059.003 Malicious File - T1204.002   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-12-18T01:06:14+00:00

---

# SQL Brute Force Leads to BlueSky Ransomware

Авторы: 


Ссылка на контент: 
https://thedfirreport.com/2023/12/04/sql-brute-force-leads-to-bluesky-ransomware/

Краткое содержание: 

<blockquote>
Using “xp_cmdshell” the threat actors first executed a PowerShell command on the SQL server.   ...   <br>The command contained base64 encoded content, which, upon execution, established a connection to a Cobalt Strike command and control server.   ...   <br>This was followed by execution of a PowerShell script which performed a variety of operations, such as checking privileges of the active user, disabling of AV solutions, and dropping of a miner payload named java.exe.   ...   <br>Depending upon the privileges of the user, the script also performs creation of scheduled tasks and Windows services to maintain persistence on the host.   ...   <br>Upon establishing access to one of the domain controllers the threat actors performed similar activity as observed on the beachhead.   ...   <br>The time to ransomware in this case was 32 minutes.   ...   <br>The linked case data is available for All Intel subscribers in event 21132 (c39d59d8-8bae-49f5-8b29-de5c13b61899).   ...   <br>The threat actor then executed a Cobalt Strike beacon and a PowerShell script that has previously been identified by Sophos as used in campaigns to deploy Tor2Mine malware.   ...   <br>The first PowerShell script executed a command to download a Cobalt Strike beacon.   ...   <br>In the last section, a script named del.ps1 is downloaded and executed on the host as a scheduled task.   ...   <br>To establish persistence in the network, multiple scheduled tasks and Windows services were created on the beachhead and one of the domain controllers.   ...   <br>The threat actor was observed running whoami from the Tor2Mine PowerShell process on the beachhead.   ...   <br>]81 which was the command and control server for the Tor2Mine malware.   ...   <br>Valid Accounts - T1078 Brute Force - T1110 Scheduled Task - T1053.005 Windows Command Shell - T1059.003 PowerShell - T1059.001 Disable or Modify Tools - T1562.001 Process Injection - T1055 LSASS Memory - T1003.001 System Owner/User Discovery - T1033 Network Share Discovery - T1135 Data Encrypted for Impact - T1486 SMB/Windows Admin Shares - T1021.002 Web Protocols - T1071.001 Service Execution - T1569.002 Modify Registry - T1112 Obfuscated Files or Information - T1027 Windows Service - T1543.003 Masquerade Task or Service - T1036.004   ...   
</blockquote>

Тэги: 


Дата публикования: 
2023-12-04T01:55:56+00:00

---

